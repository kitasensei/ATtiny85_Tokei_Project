1.概要

TM1630は、キーボードスキャンインターフェースを備えた特別なLED（発光ダイオードディスプレイ）駆動制御回路で、MCUデジタルインターフェース、データラッチ、LED高電圧駆動、キーボードスキャンおよびその他の回路を統合しています。 この製品は、優れたパフォーマンスと信頼できる品質を備えています。 主に、VCR、VCD、DVD、およびホームシアター製品のディスプレイドライバーに使用されます。 DIP18パッケージで利用可能。

2、特徴

パワーCMOSプロセス
複数の表示モード（7セグメントx 5桁から8セグメントx 4桁）
キースキャン（7×1ビット）
輝度調整回路（8段階の調整可能なデューティサイクル）
シリアルインターフェイス（CLK、STB、DIO）
発振モード：内蔵RC発振（450KHz + 5％）
内蔵パワーオンリセット回路
パッケージ：DIP18
3.ピン定義



4.ピン機能の定義

記号	ピン名	説明
DIO	データ入出力	下位ビットから始まる、クロックの立ち上がりエッジでのシリアルデータの入出力。
STB	チップ選択	立ち上がりまたは立ち下がりエッジでシリアルインターフェイスを初期化してから、受信ポインターを待ちます。命令として、STBをLowの後の最初のバイトにし、命令を処理する場合、他の現在の処理は終了し、STBがHighの場合、CLKは無視されます。
CLK	クロック入力	クロックの立ち上がりエッジでのシリアルデータの入出力
K2	キースキャンデータ入力	このピンへのデータ入力は、表示期間の終了後にラッチされます
SEG2/K2~SEG8/KS8	出力（セグメント）	セグメント出力（キースキャンとしても使用）、P-chオープンドレイン出力
GRID1~GRID4	出力（ビット）	ビット出力、N-chオープンドレイン出力
SEG14/GRID5	出力（セグメント/ビット）	セグメント/ビット多重化出力
VDD	ロジックパワー	5V±10%
GND	システムグラウンド	システムグラウンド
▲注：DIOポートがデータを出力する場合、Nchのオープンドレイン出力であるため、キーを読み取る場合は、1K〜10Kの外部プルアップ抵抗が必要です。 当社では、10Kのプルアップ抵抗を推奨しています。 DIOは、クロックの立ち下がりエッジでのNchの動作を制御しますが、このとき、読み取り値は不安定です（図（6）を参照）読み取り値は、クロックの立ち上がりエッジでのみ安定しています。



5.レジスタアドレスと表示モード

このレジスタは、シリアルインターフェイスを介して外部デバイスからTM1630に転送されたデータを格納しますアドレスは、チップのSEGおよびGRIDピンに接続されたLEDライトに対応する00H-09Hからの10バイト単位です。 データバイトの下位から上位まで、表示アドレスから操作する場合。



 

6.キースキャンおよびキースキャンデータレジスタ

以下に示すように、キースキャンは7×1ビットです。



キースキャンデータの格納アドレスを以下に示します。キーリードコマンド発行後、キーデータBYTE1〜BYTEを読み取ります。リードデータは下位ビットから出力されます。B0、B2、B3、B5、B6、B7は無効ビットです。 この時点では、チップ出力は0です。 チップのKおよびKSピンに対応するキーが押されると、対応するバイトのBITビットは1です。

B0	B1	B2	B3	B4	B5	B6	B7	
K2			K2				
0	0	0	0	KS2	0	0	0	BYTE1
0	KS3	0	0	KS4	0	0	0	BYTE2
0	KS5	0	0	KS6	0	0	0	BYTE3
0	KS7	0	0	KS8	0	0	0	BYTE4
▲注：1. TM1630は4バイトまで読み取ることができ、それ以上読み取ることはできません。

2.読み取りデータバイトは、バイト全体ではなく、BYTE1からBYTE4の順序でのみ読み取ることができます。 たとえば、ハードウェア上のK2およびKS8の対応するキーが押されたときに、この時点でキーデータを読み取る場合、4バイト目の4BITビットを読み取ってデータを読み取る必要があります。

7.手順

指示は、ディスプレイモードとLEDドライバーのステータスを設定するために使用されます。 STBの立ち下がりエッジの後にDIOによって入力された最初のバイトは、命令と見なされます。 デコード後、最上位の2ビットB7とB6を使用して、異なる命令を区別します。

B7	B6	指令
0	0	表示モード設定
0	1	データコマンド設定
1	0	表示制御コマンド設定
1	1	アドレスコマンド設定
コマンドまたはデータの送信中にSTBがハイに設定されると、シリアル通信が初期化され、送信中のコマンドまたはデータは無効になります（以前に送信されたコマンドまたはデータは有効のままです）。

(1) 表示モード設定：

B7	B6	B5	B4	B3	B2	B1	B0	表示モード
0	0	無関係、0を入力	0	0	4桁と8セグメント
0	0	0	1	5桁と7セグメント
この命令は、選択されたセグメントとビット（4〜5桁、7〜8セグメント）の数を設定するために使用されます。 命令が実行されると、ディスプレイは強制的にオフになります。 ディスプレイをオンにするディスプレイ制御コマンドを送信する場合、元のデータコンテンツは変更されませんが、同じモードが設定されている場合、上記の状況は発生しません。

(2) データ設定：

B7	B6	B5	B4	B3	B2	B1	B0	機能	説明
0	1	無関係、0を入力			0	0	データ読み取りおよび書き込みモードの設定	表示レジスタへのデータの書き込み
0	1			1	0	キースキャンデータの読み取り
0	1		0			アドレス増加モード設定	自動アドレス増加
0	1		1			固定アドレス
0	1	0				测试模式设置
（内部使用）

通常モード
0	1	1				テストモード
 

(3) アドレスコマンド設定：

B7	B6	B5	B4	B3	B2	B1	B0	アドレス表示
1	1	無関係、0を入力	0	0	0	0	00H
1	1	0	0	0	1	01H
1	1	0	0	1	0	02H
1	1	0	0	1	1	03H
1	1	0	1	0	0	04H
1	1	0	1	0	1	05H
1	1	0	1	1	0	06H
1	1	0	1	1	1	07H
1	1	1	0	0	0	08H
1	1	1		0	1	09H
この命令は、表示レジスタのアドレスを設定するために使用されます。 アドレスが0AH以上に設定されている場合、有効なアドレスが設定されるまでデータは無視されます。 電源を入れると、アドレスはデフォルトで00Hに設定されます。

(4) 表示制御：

B7	B6	B5	B4	B3	B2	B1	B0	機能	説明
１	0	無関係、0を入力		0	0	0	消光量設定	パルス幅を1/16
１	0		0	0	1	パルス幅を2/16
１	0		0	1	0	パルス幅を4/16
１	0		0	1	1	パルス幅を10/16
１	0		1	0	0	パルス幅を11/16
１	0		1	0	1	パルス幅を12/16
１	0		1	1	0	パルス幅を13/16
１	0		1	1	1	パルス幅を14/16
１	0	0				スイッチ設定の表示	OFF
１	0	1				ON
 

8. シリアルデータ伝送フォーマット：

BITの読み取りと受信の両方が、クロックの立ち上がりエッジで実行されます。

データ受信（書き込みデータ）



データの読み取り（読み取りデータ）



▲注：データを読み取る場合、シリアルクロックCLKの8番目の立ち上がりエッジの開始からCLKの立ち下がりエッジがデータを読み取るまでの待機時間Twait（最小1μS）が必要です。

9.ディスプレイキースキャン

(1)ディスプレイ

カソードコモンの表示機を駆動します。



図7は、カソードコモンのデジタル表示機の接続を示しています。デジタルチューブが「0」を表示する場合、GRID1がローのときにSEG2、SEG3、SEG4、SEG5、SEG6、SEG7をハイにする必要があります。 SEG8は低レベルです。図（9）から、GRID1が低レベル、GRID2-GRID5が高レベルであることがわかります。図（1）では、アドレスユニット00Hのみが必要であることがわかります。 その中にデータ3FHを書き込みます。

SEG14	SEG8	SEG7	SEG6	SEG5	SEG4	SEG3	SEG2	
0	0	1	1	1	1	1	1	00H
B7	B6	B5	B4	B3	B2	B1	B0	
（2）キーボードスキャン：



一般に、図（11）を使用して主要な設計要件を満たすことができます。

S1を押すと、最初のバイトのB0で「1」が読み取られます。 複数のキーが押されると、複数の「1」が読み取られますS2とS3が押されると、B1とB3の最初のバイトで「1」が読み取られます。

10. アプリケーション中のシリアルデータ送信：

（1）アドレス増加モード

アドレス自動インクリメントモードを使用すると、設定されたアドレスは実際に設定されるデータストリームの開始アドレスになります。 開始アドレスコマンドワードが送信された後、「STB」をHighに設定してからデータを送信する必要はありません。最大値は14BYTEです。「STB」はデータ送信が完了した後にのみHighに設定されます。



Command1: 表示モードを設定(00)

Command2: データ設定コマンド(01)

Command3: 表示アドレスを設定

Data1～ n: 表示データをCommand3アドレスとそれに続くアドレスに転送します（最大14バイト）

Command4: 表示制御コマンド

（2） 固定地址模式

固定アドレスモードでは、設定されたアドレスは実際には、転送される1BYTEデータが保存されるアドレスです。 アドレスが送信された後、「STB」をハイに設定する必要はなく、1BYTEデータがすぐに送信され、データ送信が完了した後、「STB」がハイに設定されます。 次に、2番目のデータを保存する必要があるアドレスをリセットします最大で14バイトのデータが送信され、「STB」がハイに設定されます。



Command1: 表示モードを設定する

Command2: データ設定コマンド

Command3: 表示アドレス1を設定

Data1: 表示データ1をCommand3アドレスに転送します

Command4: 表示アドレス2を設定

Data2: 表示データ2をCommand4アドレスに転送します

Command5: 表示制御コマンド

（3）キーシーケンスの読み取り



Command1: 设読み取りキーの設定コマンド

Data1～4: キーデータを読み取る

（4）プログラム設計フローチャート

アドレスの自動インクリメントを1つ使用するプログラム設計フローチャート：



固定アドレスを使用したプログラム設計フローチャート：



 

11. アプリケーション回路：

TM1630ドライバーの一般的なカソードコモンデジタル表示器の配線回路図（17）：



▲注：1. VDDとGNDの間のフィルターコンデンサは、PCBボード上のTM1630チップのできるだけ近くに配置して、フィルター効果を高めます。

DIO、CLK、およびSTB通信ポートに接続された3つの100Pコンデンサにより、通信ポートの干渉を低減できます。
Blu-rayデジタルチューブのオン電圧降下は約3Vなので、TM1630は5Vで駆動する必要があります。
12.電気的パラメーター

絶対定格（Ta = 25°C、Vss = 0 V）

パラメータ	記号	範囲	単位
ロジック電源電圧	VDD	-0.5 ~ +7.0	V
ロジック入力電圧	VI1	-0.5 ~ VDD + 0.5	V
LEDセグメント駆動出力電流	IO1	-50	mA
LEDグリッド駆動出力電流	IO2	+200	mA
電力損失	PD	400	mW
動作温度	Topt	-40 ~ +80	℃
保存温度	Tstg	-65 ~ +150	℃
定格動作範囲(Ta = -20 ~ +70℃, Vss = 0V)

パラメータ	記号	最小	定格	最大	単位	条件
ロジック電源電圧	VDD		5		V	
高レベル電圧	VIH	0.7 VDD		VDD	V	
低レベル電圧	VIL	0		0.3 VDD	V	
電気特性(Ta = -20 ~ +70℃, VDD = 4.5 ~ 5.5V, Vss = 0V)

パラメータ	記号	最小	定格	最大	単位	条件
SEGピンの高レベル出力電流	Ioh1	20	25	40	mA	Vo =vdd-2V
Ioh2	20	30	50	mA	Vo=vdd-3V
GRIDピンの低レベル入力電流	IOL1	-80	-140	–	mA	Vo=0.3V
低レベル出力電流	Idout	4	–	–	mA	V0 = 0.4V, dout
高レベルの出力電流耐性	Itolsg	–	–	5	%	VO = VDD – 3V，
Seg1～Seg11

出力プルダウン抵抗	RL	–	10	–	KΩ	K1~K3
入力電流	II	–	–	±1	uA	VI = VDD / VSS
高レベル入力電圧	VIH	0.7VDD	–	–	V	CLK，DIN，STB
低レベル入力電圧	VIL	–	–	0.3VDD	V	CLK，DIN，STB
ヒステリシス電圧	VH	–	0.35	–	V	CLK，DIN，STB
動的消費電流	IDDdyn	–	–	5	mA	無負荷、ディスプレイオフ
スイッチング特性（Ta = -20〜+ 70°C、VDD = 4.5〜5.5 V）

パラメータ	記号	最小	定格	最大	単位	測定条件
発振周波数	Fosc	–	500	–	KHz	R = 16.5 KΩ
伝送遅延時間	tPLZ	–	–	300	ns	CLK → DOUT
CL = 15pF, RL = 10K Ω

tPZL	–	–	100	ns
立ち上がり時間	TTZH 1	–	–	2	us	CL =
300p F

Seg1～Seg11
TTZH 2	–	–	0.5	us	Grid1～Grid4 Seg12/Grid7～ Seg14/Grid5
立ち下がり時間	TTHZ	–	–	120	us	CL = 300pF，Segn， Gridn
最大クロック周波数	Fmax	1	–	–	MHz	50％のデューティサイクル
入力容量	CI	–	–	15	pF	–
タイミング特性（Ta = -20〜+ 70°C、VDD = 4.5〜5.5 V）

パラメーター	記号	最小	定格	最大	単位	測定条件
クロックパルス幅	PWCLK	400	–	–	ns	–
ストロボパルス幅	PWSTB	1	–	–	us	–
データ作成時間	tSETUP	100	–	–	ns	–
データ保持時間	tHOLD	100	–	–	ns	–
CLK→STB時間	tCLK STB	1	–	–	us	CLK↑→STB↑
待ち時間	tWAIT	1	–	–	us	CLK↑→CLK↓
